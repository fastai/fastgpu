---
toc: false
title: fastgpu

keywords: fastai
sidebar: home_sidebar

summary: "A queue service for quickly developing scripts that use all your GPUs efficiently"
description: "A queue service for quickly developing scripts that use all your GPUs efficiently"
nb_path: "index.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: index.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>fastgpu</code> provides a single command, <code>fastgpu_poll</code>, which polls a directory to check for scripts to run, and then runs them on the first available GPU. If no GPUs are available, it waits until one is. If more than one GPU is available, multiple scripts are run in parallel, one per GPU.</p>
<p>An API is also provided for polling programmatically, which is extensible for assigning other resources to processes besides GPUs. For details on the API, see the docs for <a href="/fastgpu/core.html"><code>core</code></a>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Install">Install<a class="anchor-link" href="#Install"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>pip install fastgpu</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="How-to-use">How to use<a class="anchor-link" href="#How-to-use"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>--help</code> provides command help:</p>

<pre><code>$ fastgpu_poll --help
usage: fastgpu_poll [-h] [--path PATH] [--exit EXIT]

Poll `path` for scripts using `ResourcePoolGPU.poll_scripts`

optional arguments:
  -h, --help   show this help message and exit
  --path PATH  Path containing `to_run` directory
  --exit EXIT  Exit when `to_run` is empty</code></pre>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>path</code> defaults to the current directory. The path should contain a subdirectory <code>to_run</code> containing executable scripts you wish to run. It should not contain any other files, although it can contain subdirectories (which are ignored).</p>
<p><code>fastgpu_poll</code> will run each script in <code>to_run</code> in sorted order. Each script will be assigned to one GPU. The <code>CUDA_VISIBLE_DEVICES</code> environment variable will be set to the ID of this GPU in the script's subprocess. In addition, the <code>FASTGPU_ID</code> environment variable will also be set to this ID.</p>
<p>Once a script is selected to be run, it is moved into a directory called <code>running</code>. Once it's finished, it's moved into <code>complete</code> or <code>fail</code> as appropriate. stdout and stderr are captured to files with the same name as the script, plus <code>stdout</code> or <code>stderr</code> appended.</p>
<p>If <code>exit</code> is <code>1</code> (which is the default), then once all scripts are run, <code>fastgpu_poll</code> will exit. If it is <code>0</code> then <code>fastgpu_poll</code> will continue running until it is killed; it will keep polling for any new scripts that are added to <code>to_run</code>.</p>
<p>To limit the GPUs available to fastgpu, set <a href="https://devblogs.nvidia.com/cuda-pro-tip-control-gpu-visibility-cuda_visible_devices/">CUDA_VISIBLE_DEVICES</a> before polling, e.g.:</p>

<pre><code>CUDA_VISIBLE_DEVICES=2,3 fastgpu_poll script_dir</code></pre>

</div>
</div>
</div>
</div>
 

